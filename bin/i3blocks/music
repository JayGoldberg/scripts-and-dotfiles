#!/bin/sh
mpc status -f '%file%\n%artist%\n%title%\n%time%' | {
    read file
    read artist
    read title
    read time
    read p || { echo 'No song'; exit 33; }
    case "$p" in
        "[paused]"*)
            paused="[paused] "
            colour="#808080"
            ;;
        *)
            paused=
            case "$file" in
                *.mp3) colour='#ff80ff';;
                *.flac) colour='#80ffff';;
                *.ogg) colour='#80ff80';;
                *.xm) colour='#ff8080';;
                *) colour='#ffffff';;
            esac
            ;;
    esac

    if [ -z "$artist" ]; then friendly=$title
    elif [ -n "$title" ]; then friendly="$artist - $title"
    else friendly=
    fi

    friendly="$paused${friendly:-$file}${time:+ [$time]}"
    {
        echo "$friendly"
        echo "$paused${title:-$file}"
        echo "$colour"
    } | sed 's/&/\&amp;/g;s/</\&lt;/g;s/>/\&gt;/g;s/'\''/\&apos;/g;s/"/\&quot;/g'
}
