#!/bin/env bash

cpulim=819 # 0-1024
memlim=4096 # in MB

process="chrome"

u=$(id -un)
g=$(id -gn)
sudo cgcreate -a "$u:$g" -t "$u:$g" -g cpu,memory:${process}

echo $cpulim > /sys/fs/cgroup/cpu/${process}/cpu.shares
echo $(($memlim*1024*1024)) > /sys/fs/cgroup/memory/${process}/memory.limit_in_bytes
cgexec -g cpu,memory:chrome $@

# delete the cgroup when script exits
sudo cgdelete memory,cpu:${process}
