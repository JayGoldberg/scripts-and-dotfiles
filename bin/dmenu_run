#!/bin/sh
[ -d "${XDG_CACHE_HOME:=~/.cache}" ] || mkdir -p "$XDG_CACHE_HOME"
cache=$XDG_CACHE_HOME/dmenu_run
eval exec "$(
    IFS=:
    if stest -dqr -n "$cache" $PATH; then
        stest -flx $PATH | sort -u | tee "$cache" | dmenu "$@"
    else
        dmenu "$@" < $cache
    fi
)"
